(()=>{"use strict";var t={421:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Carrito=void 0;const o=n(r(147));let i=new Date;e.Carrito=class{constructor(t){this.timestamp=t}getCartById(t){let e=o.default.readFileSync("./src/componentes/carrito.txt","utf-8"),r=JSON.parse(e);try{return r.find((e=>e.id===t))?r.find((e=>e.id===t)):{error:"ID de carrito inexistente"}}catch(t){console.log(t)}}saveCart(){let t=o.default.readFileSync("./src/componentes/carrito.txt","utf-8"),e=JSON.parse(t),r={timestamp:i.toLocaleString()};if(e.length){let t=e[e.length-1].id+1;o.default.writeFileSync("./src/componentes/carrito.txt",JSON.stringify([...e,Object.assign(Object.assign({},r),{id:t})],null,2))}else o.default.writeFileSync("./src/componentes/carrito.txt",JSON.stringify([...e,Object.assign(Object.assign({},r),{id:1})],null,2))}deleteCartByID(t){let e=o.default.readFileSync("./src/componentes/carrito.txt","utf-8"),r=JSON.parse(e);try{if(r.find((e=>e.id===t))){const e=r.filter((e=>e.id!==t));return o.default.writeFileSync("./src/componentes/carrito.txt",JSON.stringify(e,null,2)),`Carrito ID ${t} eliminado`}return"ID de Carrito es inexistente"}catch(t){console.log(t)}}deleteProductByID(t,e){let r=o.default.readFileSync("./src/componentes/carrito.txt","utf-8"),n=JSON.parse(r);if(n.find((e=>e.id===t))){const r=n.find((e=>e.id===t));let i=n.find((e=>e.id===t)).product.filter((t=>t.id!==e));const s={timestamp:r.timestamp,products:i,id:r.id},c=n.filter((e=>e.id!==t));return c.unshift(s),o.default.writeFileSync("./src/componentes/carrito.txt",JSON.stringify(c,null,2)),{message:"Producto modificado",newCart:s}}return{error:"ID de producto inexistente"}}addProductToCart(t){let e=o.default.readFileSync("./src/componentes/carrito.txt","utf-8"),r=JSON.parse(e),n=o.default.readFileSync("./src/componentes/productos.txt","utf-8"),s=JSON.parse(n).find((e=>e.id===t)),c=[];c.push(s);let d={timestamp:i.toLocaleString(),product:c};if(r.length){let t=r[r.length-1].id+1;o.default.writeFileSync("./src/componentes/carrito.txt",JSON.stringify([...r,Object.assign(Object.assign({},d),{id:t})],null,2))}else o.default.writeFileSync("./src/componentes/carrito.txt",JSON.stringify([...r,Object.assign(Object.assign({},d),{id:1})],null,2))}}},183:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Contenedor=void 0;const o=n(r(147));let i=new Date;e.Contenedor=class{constructor(t,e,r){this.title=t,this.price=e,this.thumbnail=r}getAll(){let t=o.default.readFileSync("./src/componentes/productos.txt","utf-8"),e=JSON.parse(t);try{return e}catch(t){return t}}save(t,e,r){let n=o.default.readFileSync("./src/componentes/productos.txt","utf-8"),s=JSON.parse(n),c={title:t,price:e,thumbnail:r,timestamp:i.toLocaleString(),stock:1};if(s.length){let t=s[s.length-1].id+1;o.default.writeFileSync("./src/componentes/productos.txt",JSON.stringify([...s,Object.assign(Object.assign({},c),{id:t})],null,2))}else o.default.writeFileSync("./src/componentes/productos.txt",JSON.stringify([...s,Object.assign(Object.assign({},c),{id:1})],null,2))}getById(t){let e=o.default.readFileSync("./src/componentes/productos.txt","utf-8"),r=JSON.parse(e);try{return r.find((e=>e.id===t))?r.find((e=>e.id===t)):{error:"ID de producto inexistente"}}catch(t){console.log(t)}}upload(t,e,r,n){let i=o.default.readFileSync("./src/componentes/productos.txt","utf-8"),s=JSON.parse(i);if(s.find((e=>e.id===t))){const i={title:e,price:r,thumbnail:n,id:t},c=s.filter((e=>e.id!==t));return c.unshift(i),o.default.writeFileSync("./src/componentes/productos.txt",JSON.stringify(c,null,2)),{message:"Producto modificado",newProduct:i}}return{error:"ID de producto inexistente"}}deleteById(t){let e=o.default.readFileSync("./src/componentes/productos.txt","utf-8"),r=JSON.parse(e);try{if(r.find((e=>e.id===t))){const e=r.filter((e=>e.id!==t));return o.default.writeFileSync("./src/componentes/productos.txt",JSON.stringify(e,null,2)),`Producto ID ${t} eliminado`}return"ID de producto inexistente"}catch(t){console.log(t)}}}},607:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{d(n.next(t))}catch(t){i(t)}}function c(t){try{d(n.throw(t))}catch(t){i(t)}}function d(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,c)}d((n=n.apply(t,e||[])).next())}))},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(r(860)),s=r(183),c=r(421);r(142).config();const d=(0,i.default)();d.use(i.default.json()),d.use(i.default.urlencoded({extended:!0}));const a=new s.Contenedor("",0,""),l=new c.Carrito("");d.get("/productos",((t,e)=>{const r=a.getAll();n(void 0,void 0,void 0,(function*(){e.json(yield r)}))})),d.get("/productos/:id",((t,e)=>{const{id:r}=t.params;e.json(a.getById(Number(r)))})),d.post("/productos",((t,e)=>{const{title:r,price:n,thumbnail:o}=t.body;e.send(a.save(r,n,o))})),d.put("/productos/:id",((t,e)=>{const{id:r}=t.params,{title:n,price:o,thumbnail:i}=t.body;e.send(a.upload(Number(r),n,o,i))})),d.delete("/productos/:id",((t,e)=>{const{id:r}=t.params;e.send(a.deleteById(Number(r)))})),d.get("/carrito/:id/productos",((t,e)=>{const{id:r}=t.params;e.json(l.getCartById(Number(r)))})),d.post("/carrito",((t,e)=>{e.send(l.saveCart())})),d.delete("/carrito/:id",((t,e)=>{const{id:r}=t.params;e.send(l.deleteCartByID(Number(r)))})),d.delete("/carrito/:id/productos/:id_prod",((t,e)=>{const{id:r,id_prod:n}=t.params;e.send(l.deleteProductByID(Number(r),Number(n)))})),d.post("/carrito/:id/productos",((t,e)=>{const{id:r}=t.params;e.json(l.addProductToCart(Number(r)))}));const u=process.env.PORT;d.listen(u,(()=>{console.log("server is running on port 8080")}))},142:t=>{t.exports=require("dotenv")},860:t=>{t.exports=require("express")},147:t=>{t.exports=require("fs")}},e={};!function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}(607)})();